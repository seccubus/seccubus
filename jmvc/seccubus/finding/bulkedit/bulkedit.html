<!DOCTYPE HTML>
<html lang="en">
	<head>
		<title>Seccubus.Finding.Bulkedit</title>
        <style type='text/css'>
            body {font-family: verdana}
            .error {border: solid 1px red;}
            .error_text { color: red; font-size: 10px;}
            td {padding: 3px;}
            td {padding: 3px;}
	    .asc { background: url("img/sort_asc.png") no-repeat scroll right center ; padding-right: 20px;}
	    .desc { background: url("img/sort_desc.png") no-repeat scroll right center ;padding-right: 20px; }
	    .both { background: url("img/sort_both.png") no-repeat scroll right center ;padding-right: 20px; }
	    tr.sev_1 { background-color: red; };
	    tr.sev_2 { background-color: yellow; };
	    tr.sev_3 { background-color: green; };
	    tr.sev_4 { background-color: blue; };
        </style>
	</head>
	<body>
	    <h1>Seccubus.Finding.Bulkedit Demo</h1>
		Workspace: <select id='workspace'></select><br>
		Scan(s):<br>
		<select multiple id='scans' size=8></select><br><br>
		Status:
		<a href='javascript://' class='setStatus' value=1>1 New</a>
		<a href='javascript://' class='setStatus' value=2>2 Changed</a>
		<a href='javascript://' class='setStatus' value=3>3 Open</a>
		<a href='javascript://' class='setStatus' value=4>4 No Issue</a>
		<a href='javascript://' class='setStatus' value=5>5 Gone</a>
		<a href='javascript://' class='setStatus' value=6>6 Closed</a>
		<a href='javascript://' class='setStatus' value=99>99 MASKED</a><br>
		<br>
		<form id='bulkedit'></form>
		<br>
		<table id='findings' border=1></table>
		<script type='text/javascript' 
                src='../../../steal/steal.js'>
        </script>
		<script type='text/javascript'>
			steal(	'seccubus/finding/table',
				'seccubus/workspace/select',
				'seccubus/scan/select',
		//		'seccubus/fixtures',
				'seccubus/finding/bulkedit',
			function(){

				var gui_state=new Seccubus.GuiState({
					workspace       : -1
				});
				gui_state.bind("workspace", function(ev, ws){
					$('#scans').seccubus_scan_select({
						workspace	: gui_state.attr("workspace"),
					});
					update_findings();
				});
				gui_state.bind("status", function(){
					update_findings();
				});
				gui_state.bind("scans", function(ev, sc){
					update_findings();
				});
				$('#workspace').change(function() {
					gui_state.attr("workspace",$(this).attr("value"));
				});
				$('#scans').change( function() {
					gui_state.attr("scans", $(this).val());
				});

				$('#workspace').seccubus_workspace_select();
				$('#workspace').attr("value", -1);
				$('#scans').seccubus_scan_select();
				$('#findings').seccubus_finding_table();

				$('.setStatus').click( function(){
					s = $(this).attr("value");
					gui_state.attr("status",s);
				});

				$('#bulkedit').seccubus_finding_bulkedit({
					workspace	: gui_state.attr("workspace"),
					status		: gui_state.attr("status"),
				});

				function update_findings() {
					$('#findings').seccubus_finding_table({
						workspace	: gui_state.attr("workspace"),
						scans		: gui_state.attr("scans"),
						status		: gui_state.attr("status"),
					});
					$('#bulkedit').seccubus_finding_bulkedit({
						workspace	: gui_state.attr("workspace"),
						scans		: gui_state.attr("scans"),
						status		: gui_state.attr("status"),
					});
				};
			})
		</script>
	</body>
</html>
